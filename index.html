<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>GembaWalk</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap');

:root {
  --bg: #f4f3ef;
  --surface: #ffffff;
  --surface2: #eeede9;
  --border: #dddcd7;
  --text: #1a1917;
  --text-muted: #7a7870;
  --text-dim: #a09e98;
  --accent: #1a4d3e;
  --accent-light: #e8f0ed;
  --accent2: #c84b1f;
  --accent2-light: #fdf0eb;
  --gold: #b8860b;
  --gold-light: #fdf8e8;
  --ws-color: #1a6e3c;
  --ws-bg: #e8f5ee;
  --nws-color: #c84b1f;
  --nws-bg: #fdf0eb;
  --nnotw-color: #7a5c00;
  --nnotw-bg: #fef9e7;
  --radius: 14px;
  --radius-sm: 9px;
  --shadow: 0 2px 12px rgba(0,0,0,0.08);
}

* { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'IBM Plex Sans', sans-serif;
  min-height: 100vh;
  max-width: 480px;
  margin: 0 auto;
  padding-bottom: 72px;
  font-size: 15px;
}

/* ===== SCREENS ===== */
.screen { display: none; animation: fadeIn 0.2s ease; }
.screen.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

/* ===== START SCREEN ===== */
#startScreen {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 32px 24px 48px;
  gap: 28px;
}
#startScreen.active { display: flex; }

.logo-wrap { text-align: center; }
.logo-wrap h1 {
  font-size: 36px;
  font-weight: 700;
  letter-spacing: -0.02em;
  color: var(--accent);
  margin-bottom: 4px;
}
.logo-wrap h1 span { color: var(--text); font-weight: 300; }
.logo-wrap p { color: var(--text-muted); font-size: 14px; }

.type-grid { display: flex; flex-direction: column; gap: 12px; width: 100%; }

.type-card {
  background: var(--surface);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  cursor: pointer;
  transition: all 0.18s;
  display: flex;
  align-items: center;
  gap: 16px;
  box-shadow: var(--shadow);
}
.type-card:active { transform: scale(0.98); }
.type-card.arzt:hover, .type-card.arzt:active { border-color: var(--accent); background: var(--accent-light); }
.type-card.admin:hover, .type-card.admin:active { border-color: var(--accent2); background: var(--accent2-light); }
.type-card .type-emoji { font-size: 36px; flex-shrink: 0; }
.type-card .type-text h3 { font-size: 17px; font-weight: 600; margin-bottom: 2px; }
.type-card .type-text p { font-size: 13px; color: var(--text-muted); line-height: 1.4; }
.type-card.arzt .type-text h3 { color: var(--accent); }
.type-card.admin .type-text h3 { color: var(--accent2); }

/* Observer name input on start */
.observer-field { width: 100%; }
.observer-field label { font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; color: var(--text-muted); display: block; margin-bottom: 6px; }

/* ===== HEADER ===== */
.app-header {
  background: var(--surface);
  border-bottom: 2px solid var(--border);
  padding: 12px 16px;
  position: sticky;
  top: 0;
  z-index: 200;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.header-left h2 { font-size: 15px; font-weight: 700; letter-spacing: 0.02em; color: var(--accent); }
.header-left .header-meta { font-size: 11px; color: var(--text-muted); font-family: 'IBM Plex Mono', monospace; margin-top: 1px; }
.header-right { display: flex; gap: 8px; align-items: center; }

.type-pill {
  font-size: 10px;
  font-weight: 700;
  padding: 3px 9px;
  border-radius: 20px;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}
.pill-arzt { background: var(--accent-light); color: var(--accent); border: 1px solid rgba(26,77,62,0.2); }
.pill-admin { background: var(--accent2-light); color: var(--accent2); border: 1px solid rgba(200,75,31,0.2); }

/* ===== BOTTOM TABS ===== */
.bottom-tabs {
  position: fixed; bottom: 0; left: 50%; transform: translateX(-50%);
  width: 100%; max-width: 480px;
  background: var(--surface);
  border-top: 2px solid var(--border);
  display: flex; z-index: 300;
}
.tab-btn {
  flex: 1; padding: 9px 0 11px;
  display: flex; flex-direction: column; align-items: center; gap: 2px;
  cursor: pointer; color: var(--text-muted);
  font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em;
  border: none; background: none; font-family: 'IBM Plex Sans', sans-serif;
  transition: color 0.15s;
}
.tab-btn .tab-icon { font-size: 21px; }
.tab-btn.active { color: var(--accent); }

/* ===== SHARED COMPONENTS ===== */
.section-pad { padding: 16px; }

.field-label {
  font-size: 11px; font-weight: 600;
  text-transform: uppercase; letter-spacing: 0.08em;
  color: var(--text-muted); margin-bottom: 5px;
}

input[type="text"], select, textarea {
  width: 100%;
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: var(--radius-sm);
  color: var(--text);
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 15px;
  padding: 10px 13px;
  outline: none;
  transition: border-color 0.15s;
  appearance: none;
  -webkit-appearance: none;
}
input[type="text"]:focus, select:focus, textarea:focus { border-color: var(--accent); }
select { padding-right: 36px; cursor: pointer; }
.select-wrap { position: relative; }
.select-arrow { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); pointer-events: none; color: var(--text-muted); font-size: 12px; }
textarea { resize: none; line-height: 1.4; }

.btn {
  border: none; border-radius: var(--radius-sm);
  font-family: 'IBM Plex Sans', sans-serif;
  font-weight: 600; font-size: 15px;
  padding: 12px 20px; cursor: pointer;
  transition: all 0.15s; width: 100%;
  letter-spacing: 0.01em;
}
.btn:active { transform: scale(0.98); opacity: 0.9; }
.btn-primary { background: var(--accent); color: white; }
.btn-danger { background: var(--accent2); color: white; }
.btn-ghost { background: var(--surface2); border: 1.5px solid var(--border); color: var(--text); }
.btn-sm { font-size: 13px; padding: 8px 14px; width: auto; }
.btn-reset { background: var(--surface); border: 1.5px solid var(--border); color: var(--text-muted); font-size: 12px; padding: 6px 11px; border-radius: 6px; font-family: 'IBM Plex Sans', sans-serif; cursor: pointer; }
.btn-reset:active { background: var(--surface2); }

.row-2 { display: flex; gap: 10px; }
.row-2 > * { flex: 1; }

.spacer { margin-bottom: 12px; }
.spacer-sm { margin-bottom: 8px; }

/* ===== TIMER CARD ===== */
.timer-card {
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  box-shadow: var(--shadow);
}

.timer-display {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 52px;
  font-weight: 600;
  text-align: center;
  color: var(--text);
  line-height: 1;
  padding: 8px 0;
  letter-spacing: 0.02em;
  transition: color 0.3s;
}
.timer-display.running { color: var(--accent); }
.timer-display.stopped { color: var(--text-muted); }

.status-row {
  display: flex; align-items: center; justify-content: center;
  gap: 6px; font-size: 12px; color: var(--text-muted);
  margin-bottom: 10px; min-height: 18px;
}
.pulse-dot {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--accent2); display: none;
  animation: blink 1.2s ease-in-out infinite;
}
.pulse-dot.visible { display: inline-block; }
@keyframes blink { 0%,100%{opacity:1;} 50%{opacity:0.3;} }

/* ===== TAGS: T√§tigkeitstyp & Verrechnung ===== */
.tag-group { display: flex; flex-wrap: wrap; gap: 7px; }
.tag {
  padding: 6px 13px; border-radius: 20px;
  font-size: 13px; font-weight: 500; cursor: pointer;
  border: 1.5px solid var(--border); background: var(--surface);
  color: var(--text-muted); transition: all 0.12s;
  white-space: nowrap;
}
.tag:active { transform: scale(0.96); }
.tag.selected-ws { background: var(--ws-bg); border-color: var(--ws-color); color: var(--ws-color); font-weight: 600; }
.tag.selected-nws { background: var(--nws-bg); border-color: var(--nws-color); color: var(--nws-color); font-weight: 600; }
.tag.selected-nnotw { background: var(--nnotw-bg); border-color: var(--nnotw-color); color: var(--nnotw-color); font-weight: 600; }
.tag.selected-verr { background: var(--accent-light); border-color: var(--accent); color: var(--accent); font-weight: 600; }
.tag.selected-nverr { background: var(--surface2); border-color: var(--text-muted); color: var(--text); font-weight: 600; }

/* ===== QUICK PATIENT CHIPS ===== */
.chip-row { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 7px; }
.chip {
  background: var(--surface2); border: 1.5px solid var(--border);
  border-radius: 20px; padding: 4px 11px;
  font-size: 12px; color: var(--text-muted); cursor: pointer;
  transition: all 0.12s; white-space: nowrap;
}
.chip:active { background: var(--accent-light); border-color: var(--accent); color: var(--accent); }

/* ===== EINTR√ÑGE LIST ===== */
.entry-list { display: flex; flex-direction: column; gap: 8px; }
.entry-card {
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 12px 14px;
  display: flex; align-items: flex-start; gap: 10px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.04);
}
.entry-type-bar {
  width: 4px; border-radius: 3px; flex-shrink: 0;
  align-self: stretch; min-height: 36px;
}
.bar-ws { background: var(--ws-color); }
.bar-nws { background: var(--nws-color); }
.bar-nnotw { background: var(--gold); }
.bar-none { background: var(--border); }

.entry-body { flex: 1; min-width: 0; }
.entry-task { font-weight: 600; font-size: 14px; line-height: 1.3; }
.entry-patient { font-size: 12px; color: var(--text-muted); margin-top: 2px; }
.entry-tags { display: flex; flex-wrap: wrap; gap: 5px; margin-top: 6px; }
.mini-tag {
  font-size: 10px; font-weight: 600; padding: 2px 7px;
  border-radius: 10px; text-transform: uppercase; letter-spacing: 0.04em;
}
.mt-ws { background: var(--ws-bg); color: var(--ws-color); }
.mt-nws { background: var(--nws-bg); color: var(--nws-color); }
.mt-nnotw { background: var(--nnotw-bg); color: var(--nnotw-color); }
.mt-verr { background: var(--accent-light); color: var(--accent); }
.mt-nverr { background: var(--surface2); color: var(--text-muted); }
.entry-note { font-size: 12px; color: var(--text-dim); margin-top: 4px; font-style: italic; line-height: 1.3; }

.entry-right { text-align: right; flex-shrink: 0; }
.entry-dur {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 16px; font-weight: 600; color: var(--accent);
}
.entry-time { font-size: 10px; color: var(--text-muted); font-family: 'IBM Plex Mono', monospace; margin-top: 2px; }
.entry-del { background: none; border: none; color: var(--text-dim); font-size: 16px; cursor: pointer; padding: 2px 0; margin-top: 6px; display: block; }
.entry-del:active { color: var(--accent2); }

.empty-state { text-align: center; padding: 56px 24px; color: var(--text-muted); }
.empty-state .ei { font-size: 44px; margin-bottom: 10px; }
.empty-state p { font-size: 14px; line-height: 1.5; }

/* ===== MONITORING ===== */
.stats-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 4px; }
.stat-box {
  background: var(--surface); border: 1.5px solid var(--border);
  border-radius: var(--radius-sm); padding: 14px 12px; text-align: center;
  box-shadow: var(--shadow);
}
.stat-val { font-family: 'IBM Plex Mono', monospace; font-size: 22px; font-weight: 600; color: var(--accent); }
.stat-lbl { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.06em; color: var(--text-muted); margin-top: 3px; }

.section-title {
  font-size: 11px; font-weight: 700;
  text-transform: uppercase; letter-spacing: 0.1em;
  color: var(--text-muted);
  margin: 18px 0 10px;
  padding-bottom: 6px;
  border-bottom: 2px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
}

.toggle-row { display: flex; background: var(--surface2); border-radius: 8px; padding: 3px; margin-bottom: 12px; }
.toggle-btn {
  flex: 1; padding: 7px 4px; text-align: center;
  font-size: 13px; font-weight: 500; cursor: pointer;
  border-radius: 6px; color: var(--text-muted);
  transition: all 0.15s; border: none; background: none;
  font-family: 'IBM Plex Sans', sans-serif;
}
.toggle-btn.active { background: var(--surface); color: var(--text); font-weight: 600; box-shadow: 0 1px 4px rgba(0,0,0,0.08); }

.bar-item { display: flex; align-items: center; gap: 10px; margin-bottom: 9px; }
.bar-name { font-size: 13px; width: 130px; flex-shrink: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.bar-track { flex: 1; background: var(--surface2); border-radius: 4px; height: 9px; overflow: hidden; }
.bar-fill { height: 100%; border-radius: 4px; transition: width 0.4s ease; }
.fill-ws { background: var(--ws-color); }
.fill-nws { background: var(--nws-color); }
.fill-nnotw { background: var(--gold); }
.fill-accent { background: var(--accent); }
.bar-val { font-family: 'IBM Plex Mono', monospace; font-size: 12px; color: var(--text-muted); width: 45px; text-align: right; }

.legend-row { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 14px; }
.legend-item { display: flex; align-items: center; gap: 5px; font-size: 12px; color: var(--text-muted); }
.legend-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }

/* ===== EXPORT ===== */
.export-box {
  background: var(--surface); border: 1.5px solid var(--border);
  border-radius: var(--radius-sm); padding: 14px;
  margin-top: 12px; box-shadow: var(--shadow);
}
.export-info { font-size: 13px; color: var(--text-muted); margin-bottom: 12px; line-height: 1.5; }
.sharepoint-hint {
  background: var(--accent-light); border: 1px solid rgba(26,77,62,0.2);
  border-radius: var(--radius-sm); padding: 12px;
  font-size: 12px; color: var(--accent); line-height: 1.5; margin-top: 10px;
}
.sharepoint-hint strong { display: block; margin-bottom: 3px; }

/* ===== TOAST ===== */
.toast {
  position: fixed; bottom: 80px; left: 50%;
  transform: translateX(-50%) translateY(12px);
  background: var(--text); color: white;
  padding: 9px 20px; border-radius: 20px;
  font-size: 13px; font-weight: 500;
  opacity: 0; transition: all 0.25s; z-index: 500;
  white-space: nowrap; box-shadow: 0 4px 16px rgba(0,0,0,0.2);
  pointer-events: none;
}
.toast.visible { opacity: 1; transform: translateX(-50%) translateY(0); }

hr.divider { border: none; border-top: 1.5px solid var(--border); margin: 12px 0; }
</style>
</head>
<body>

<!-- ==================== START SCREEN ==================== -->
<div id="startScreen" class="screen active">
  <div class="logo-wrap">
    <h1>Gemba<span>Walk</span></h1>
    <p>Zeiterfassung & Prozessbeobachtung</p>
  </div>

  <div class="observer-field">
    <div class="field-label">Beobachter/in</div>
    <input type="text" id="observerInput" placeholder="Name eingeben..." autocomplete="off">
  </div>

  <div class="type-grid">
    <div class="type-card arzt" onclick="startSession('arzt')">
      <div class="type-emoji">üë®‚Äç‚öïÔ∏è</div>
      <div class="type-text">
        <h3>Arzt / Pflege</h3>
        <p>Patientenkontakt, KISIM, Dokumentation</p>
      </div>
    </div>
    <div class="type-card admin" onclick="startSession('admin')">
      <div class="type-emoji">üóÇÔ∏è</div>
      <div class="type-text">
        <h3>Administration</h3>
        <p>Koordination, Berichtswesen, Verwaltung</p>
      </div>
    </div>
  </div>
</div>

<!-- ==================== APP WRAPPER ==================== -->
<div id="appWrapper" style="display:none;">

  <!-- HEADER -->
  <div class="app-header">
    <div class="header-left">
      <h2>GEMBA WALK</h2>
      <div class="header-meta" id="headerMeta">‚Äì</div>
    </div>
    <div class="header-right">
      <span class="type-pill" id="typePill"></span>
      <button class="btn-reset" onclick="confirmReset()">‚Ü© Ende</button>
    </div>
  </div>

  <!-- ====== TAB: ERFASSUNG ====== -->
  <div id="tabErfassung" class="screen active">
    <div class="section-pad">

      <!-- Task -->
      <div class="spacer">
        <div class="field-label">Aktivit√§t / Prozessschritt</div>
        <div class="select-wrap">
          <select id="taskSelect">
            <option value="">‚Äì Task w√§hlen ‚Äì</option>
          </select>
          <div class="select-arrow">‚ñº</div>
        </div>
        <div class="chip-row" id="recentTasks"></div>
      </div>

      <!-- Patient -->
      <div class="spacer">
        <div class="field-label">Patient / Fall</div>
        <input type="text" id="patientInput" placeholder="Patientenname oder K√ºrzel‚Ä¶" autocomplete="off">
        <div class="chip-row" id="recentPatients"></div>
      </div>

      <!-- Timer -->
      <div class="timer-card spacer">
        <div class="status-row">
          <span class="pulse-dot" id="pulseDot"></span>
          <span id="timerStatus">Bereit</span>
        </div>
        <div class="timer-display stopped" id="timerDisplay">00:00:00</div>
        <div id="timerBtns" style="margin-top:10px;"></div>
      </div>

      <hr class="divider">

      <!-- T√§tigkeitstyp -->
      <div class="spacer">
        <div class="field-label">T√§tigkeitstyp</div>
        <div class="tag-group" id="typeTagGroup">
          <div class="tag" data-val="wertsch√∂pfend" onclick="selectType(this)">‚úÖ Wertsch√∂pfend</div>
          <div class="tag" data-val="nicht wertsch√∂pfend" onclick="selectType(this)">‚ùå Nicht wertsch√∂pfend</div>
          <div class="tag" data-val="notwendig nicht wertsch√∂pfend" onclick="selectType(this)">‚ö†Ô∏è Notwendig, aber nicht wertsch√∂pfend</div>
        </div>
      </div>

      <!-- Verrechnung -->
      <div class="spacer">
        <div class="field-label">Verrechnung</div>
        <div class="tag-group" id="verrTagGroup">
          <div class="tag" data-val="ja" onclick="selectVerr(this)">üí∞ Verrechenbar</div>
          <div class="tag" data-val="nein" onclick="selectVerr(this)">‚Äî Nicht verrechenbar</div>
        </div>
      </div>

      <!-- Beteiligt (Arzt-Modus) -->
      <div class="spacer" id="beteiligtRow" style="display:none;">
        <div class="field-label">Beteiligt</div>
        <div class="tag-group" id="beteiligtGroup">
          <div class="tag" data-val="Oberarzt" onclick="toggleBeteiligt(this)">ü©∫ Oberarzt</div>
          <div class="tag" data-val="Assistenzarzt" onclick="toggleBeteiligt(this)">ü©∫ Assistenzarzt</div>
          <div class="tag" data-val="Chirurg" onclick="toggleBeteiligt(this)">üî™ Chirurg</div>
          <div class="tag" data-val="An√§sthesie" onclick="toggleBeteiligt(this)">üíâ An√§sthesie</div>
          <div class="tag" data-val="Pflege" onclick="toggleBeteiligt(this)">üíä Pflege</div>
          <div class="tag" data-val="Patient" onclick="toggleBeteiligt(this)">üßë Patient</div>
          <div class="tag" data-val="Therapie" onclick="toggleBeteiligt(this)">üèÉ Therapie</div>
          <div class="tag" data-val="Supervision" onclick="toggleBeteiligt(this)">üëÅÔ∏è Supervision</div>
        </div>
      </div>

      <!-- Kommentar -->
      <div class="spacer">
        <div class="field-label">Kommentar (optional)</div>
        <textarea id="kommentarInput" rows="2" placeholder="Beobachtung, Idee, Potenzial‚Ä¶"></textarea>
      </div>

    </div>
  </div>

  <!-- ====== TAB: EINTR√ÑGE ====== -->
  <div id="tabEintraege" class="screen">
    <div class="section-pad">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <div style="font-size:13px;color:var(--text-muted);"><span id="entryCount">0</span> Eintr√§ge</div>
        <button class="btn btn-sm btn-ghost" onclick="clearAllEntries()">üóë Alle l√∂schen</button>
      </div>
      <div class="entry-list" id="entryList">
        <div class="empty-state">
          <div class="ei">‚è±Ô∏è</div>
          <p>Noch keine Eintr√§ge.<br>Starte auf dem Erfassungs-Tab.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ====== TAB: MONITORING ====== -->
  <div id="tabMonitoring" class="screen">
    <div class="section-pad">

      <!-- KPI Boxes -->
      <div class="stats-row" id="kpiRow">
        <div class="stat-box"><div class="stat-val" id="kpiTotal">‚Äì</div><div class="stat-lbl">Gesamtzeit</div></div>
        <div class="stat-box"><div class="stat-val" id="kpiCount">‚Äì</div><div class="stat-lbl">Eintr√§ge</div></div>
        <div class="stat-box"><div class="stat-val" id="kpiWS">‚Äì</div><div class="stat-lbl">Wertsch√∂pfend</div></div>
        <div class="stat-box"><div class="stat-val" id="kpiVerr">‚Äì</div><div class="stat-lbl">Verrechenbar</div></div>
      </div>

      <!-- Legend -->
      <div class="legend-row" style="margin-top:14px;">
        <div class="legend-item"><div class="legend-dot" style="background:var(--ws-color)"></div>Wertsch√∂pfend</div>
        <div class="legend-item"><div class="legend-dot" style="background:var(--nws-color)"></div>Nicht wertsch√∂pfend</div>
        <div class="legend-item"><div class="legend-dot" style="background:var(--gold)"></div>Notwendig n.w.</div>
      </div>

      <!-- Toggle -->
      <div class="toggle-row" id="monToggle">
        <button class="toggle-btn active" onclick="setMonView('task', this)">Nach Task</button>
        <button class="toggle-btn" onclick="setMonView('patient', this)">Nach Patient</button>
        <button class="toggle-btn" onclick="setMonView('type', this)">T√§tigkeitstyp</button>
      </div>

      <div id="monContent"></div>

      <!-- Export -->
      <div class="section-title">Export</div>
      <div class="export-box">
        <div class="export-info">CSV-Export f√ºr Excel / SharePoint. Alle Felder wie im Original-Screening-Sheet (Zeit, Aktivit√§t, T√§tigkeitstyp, Verrechnung, Patient, Kommentar).</div>
        <button class="btn btn-primary" onclick="exportCSV()">üì• &nbsp;CSV herunterladen</button>
        <div class="sharepoint-hint">
          <strong>üí° SharePoint-Tipp</strong>
          CSV herunterladen ‚Üí In SharePoint-Bibliothek hochladen ‚Üí Mit Excel √∂ffnen ‚Üí Pivot-Auswertung m√∂glich. F√ºr Mehrbenutzer-Betrieb: QR-Code auf diese HTML-Datei erstellen und Datei in SharePoint ablegen.
        </div>
        <button class="btn btn-ghost" style="margin-top:10px;" onclick="sendReportEmail()">üìß &nbsp;Bericht an carmen.huber@kispisg.ch senden</button>
      </div>

    </div>
  </div>

  <!-- BOTTOM TABS -->
  <div class="bottom-tabs">
    <button class="tab-btn active" id="tab0" onclick="switchTab(0)">
      <span class="tab-icon">‚è±Ô∏è</span>Erfassung
    </button>
    <button class="tab-btn" id="tab1" onclick="switchTab(1)">
      <span class="tab-icon">üìã</span>Eintr√§ge
    </button>
    <button class="tab-btn" id="tab2" onclick="switchTab(2)">
      <span class="tab-icon">üìä</span>Monitoring
    </button>
  </div>

</div><!-- end appWrapper -->

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
// ===========================
// DATA & STATE
// ===========================
const TASKS = {
  arzt: [
    'Patientenanmeldung',
    'Arztrapport / √úbergabe',
    'KISIM lesen',
    'Fallvorbereitung / Informationssuche',
    'Besprechung Patient',
    'Patientenbesuch / Untersuchung',
    'Teaching / Supervision',
    'Labor / Bildgebung',
    'Interprofessionelle Abstimmung',
    'Telefonat intern',
    'Telefonat extern',
    'KISIM Dokumentation',
    'Medi-Erfassung',
    'Rezept schreiben',
    'Leistungserfassung',
    'Bericht schreiben',
    'Warten auf Arzt / Pflege',
    'Warten auf Patient',
    'Administrative T√§tigkeit',
    'Sonstiges'
  ],
  admin: [
    'Terminkoordination mit Arzt',
    'Terminkoordination mit Patient',
    'Terminkoordination externe Partner',
    'Terminkoordination interne Partner',
    'Berichtswesen',
    'E-Mail Bearbeitung',
    'Telefon intern',
    'Telefon extern',
    'Dokumentenablage / Archivierung',
    'Rechnungsstellung / Codierung',
    'Informationssuche',
    'Meeting / Besprechung',
    'Datenpflege / Systemerfassung',
    'Warten / Leerlauf',
    'Sonstiges'
  ]
};

let state = {
  type: '',          // 'arzt' | 'admin'
  observer: '',
  entries: [],
  timer: { running: false, start: null, elapsed: 0, interval: null },
  currentBeteiligt: [],
  selectedType: '',
  selectedVerr: '',
  recentPatients: [],
  recentTasks: [],
  sessionDate: '',
  monView: 'task'
};

// ===========================
// SESSION
// ===========================
function startSession(type) {
  state.type = type;
  state.observer = document.getElementById('observerInput').value.trim() || 'Anonym';
  state.sessionDate = new Date().toLocaleDateString('de-CH');
  state.entries = loadEntries(type);

  // Header
  document.getElementById('headerMeta').textContent =
    state.observer + ' ¬∑ ' + state.sessionDate;
  const pill = document.getElementById('typePill');
  if (type === 'arzt') {
    pill.textContent = 'üë®‚Äç‚öïÔ∏è Arzt/Pflege';
    pill.className = 'type-pill pill-arzt';
    document.getElementById('beteiligtRow').style.display = '';
  } else {
    pill.textContent = 'üóÇÔ∏è Admin';
    pill.className = 'type-pill pill-admin';
    document.getElementById('beteiligtRow').style.display = 'none';
  }

  // Populate task dropdown
  buildTaskDropdown();

  // Show app
  document.getElementById('startScreen').classList.remove('active');
  document.getElementById('appWrapper').style.display = 'block';

  renderRecentChips();
  updateTimerUI();
  renderEntries();
  renderMonitoring();
}

function confirmReset() {
  if (state.entries.length > 0) {
    if (!confirm('Session beenden? Nicht exportierte Daten gehen verloren.')) return;
  }
  stopTimer();
  state = { ...state, entries: [], timer: { running: false, start: null, elapsed: 0, interval: null },
    currentBeteiligt: [], selectedType: '', selectedVerr: '', recentPatients: [], recentTasks: [] };
  document.getElementById('appWrapper').style.display = 'none';
  document.getElementById('startScreen').classList.add('active');
  switchTab(0);
}

function loadEntries(type) {
  try {
    const key = 'gemba_entries_' + type;
    return JSON.parse(localStorage.getItem(key) || '[]');
  } catch(e) { return []; }
}

function saveEntries() {
  try {
    const key = 'gemba_entries_' + state.type;
    localStorage.setItem(key, JSON.stringify(state.entries));
  } catch(e) {}
}

function buildTaskDropdown() {
  const sel = document.getElementById('taskSelect');
  const tasks = TASKS[state.type];
  // Reorder: recent first
  const recent = state.recentTasks.slice(0, 5);
  const others = tasks.filter(t => !recent.includes(t));
  const ordered = [...recent, ...others];
  sel.innerHTML = '<option value="">‚Äì Task w√§hlen ‚Äì</option>';
  if (recent.length > 0) {
    const grp1 = document.createElement('optgroup');
    grp1.label = 'üïê Zuletzt verwendet';
    recent.forEach(t => { const o = new Option(t, t); grp1.appendChild(o); });
    sel.appendChild(grp1);
    const grp2 = document.createElement('optgroup');
    grp2.label = 'Alle Tasks';
    others.forEach(t => { const o = new Option(t, t); grp2.appendChild(o); });
    sel.appendChild(grp2);
  } else {
    ordered.forEach(t => { const o = new Option(t, t); sel.appendChild(o); });
  }
}

// ===========================
// TIMER
// ===========================
function updateTimerUI() {
  const { running, elapsed } = state.timer;
  const total = running
    ? elapsed + (Date.now() - state.timer.start)
    : elapsed;

  const h = Math.floor(total / 3600000);
  const m = Math.floor((total % 3600000) / 60000);
  const s = Math.floor((total % 60000) / 1000);
  const fmt = n => String(n).padStart(2, '0');
  document.getElementById('timerDisplay').textContent = `${fmt(h)}:${fmt(m)}:${fmt(s)}`;
  document.getElementById('timerDisplay').className = 'timer-display ' + (running ? 'running' : 'stopped');

  const dot = document.getElementById('pulseDot');
  const status = document.getElementById('timerStatus');
  const task = document.getElementById('taskSelect').value;
  const patient = document.getElementById('patientInput').value.trim();

  if (running) {
    dot.classList.add('visible');
    status.textContent = (task ? task : 'L√§uft‚Ä¶') + (patient ? ' ¬∑ ' + patient : '');
  } else {
    dot.classList.remove('visible');
    status.textContent = total > 0 ? 'Gestoppt' : 'Bereit';
  }

  const btns = document.getElementById('timerBtns');
  const saveBtn = document.getElementById('saveBtn');
  if (!running && elapsed === 0) {
    btns.innerHTML = `<button class="btn btn-primary" onclick="startTimer()">‚ñ∂ Start</button>`;
  } else if (running) {
    btns.innerHTML = `<button class="btn btn-danger" onclick="stopTimer()">‚èπ Stop & Speichern</button>`;
  } else {
    btns.innerHTML = `<button class="btn btn-primary" onclick="startTimer()">‚ñ∂ Start</button>`;
  }
}

function startTimer() {
  state.timer.running = true;
  state.timer.start = Date.now();
  state.timer.interval = setInterval(updateTimerUI, 1000);
  updateTimerUI();
}

function stopTimer() {
  if (!state.timer.running) return;
  state.timer.elapsed += Date.now() - state.timer.start;
  state.timer.running = false;
  clearInterval(state.timer.interval);
  updateTimerUI();
  // Auto-save entry after stop
  saveEntry();
}

function resumeTimer() {
  state.timer.running = true;
  state.timer.start = Date.now();
  state.timer.interval = setInterval(updateTimerUI, 1000);
  updateTimerUI();
}

function resetTimer() {
  clearInterval(state.timer.interval);
  state.timer = { running: false, start: null, elapsed: 0, interval: null };
  updateTimerUI();
}

// ===========================
// TAG SELECTION
// ===========================
function selectType(el) {
  document.querySelectorAll('#typeTagGroup .tag').forEach(t => t.className = 'tag');
  const val = el.dataset.val;
  state.selectedType = val;
  if (val === 'wertsch√∂pfend') el.classList.add('selected-ws');
  else if (val === 'nicht wertsch√∂pfend') el.classList.add('selected-nws');
  else el.classList.add('selected-nnotw');
}

function selectVerr(el) {
  document.querySelectorAll('#verrTagGroup .tag').forEach(t => t.className = 'tag');
  state.selectedVerr = el.dataset.val;
  el.classList.add(el.dataset.val === 'ja' ? 'selected-verr' : 'selected-nverr');
}

function toggleBeteiligt(el) {
  const val = el.dataset.val;
  if (state.currentBeteiligt.includes(val)) {
    state.currentBeteiligt = state.currentBeteiligt.filter(v => v !== val);
    el.className = 'tag';
  } else {
    state.currentBeteiligt.push(val);
    el.classList.add('selected-ws');
  }
}

// ===========================
// RECENT CHIPS
// ===========================
function renderRecentChips() {
  const pContainer = document.getElementById('recentPatients');
  pContainer.innerHTML = '';
  state.recentPatients.slice(0, 6).forEach(p => {
    const c = document.createElement('div');
    c.className = 'chip';
    c.textContent = p;
    c.onclick = () => { document.getElementById('patientInput').value = p; };
    pContainer.appendChild(c);
  });

  const tContainer = document.getElementById('recentTasks');
  tContainer.innerHTML = '';
  state.recentTasks.slice(0, 4).forEach(t => {
    const c = document.createElement('div');
    c.className = 'chip';
    c.textContent = t;
    c.onclick = () => { document.getElementById('taskSelect').value = t; };
    tContainer.appendChild(c);
  });
}

function addToRecent(arr, val, max) {
  if (!val) return arr;
  const filtered = arr.filter(v => v !== val);
  return [val, ...filtered].slice(0, max);
}

// ===========================
// SAVE ENTRY
// ===========================
function saveEntry() {
  const task = document.getElementById('taskSelect').value;
  const patient = document.getElementById('patientInput').value.trim();
  const kommentar = document.getElementById('kommentarInput').value.trim();

  if (!task) { showToast('‚ö†Ô∏è Bitte Task ausw√§hlen'); return; }
  if (state.timer.elapsed === 0) return; // nothing to save

  const durationMs = state.timer.elapsed;
  const durationMin = Math.round(durationMs / 60000 * 10) / 10;
  const now = new Date();

  const entry = {
    id: Date.now(),
    time: now.toLocaleTimeString('de-CH', { hour: '2-digit', minute: '2-digit' }),
    timestamp: now.toISOString(),
    task,
    patient,
    taetigkeitstyp: state.selectedType,
    verrechnung: state.selectedVerr,
    beteiligt: [...state.currentBeteiligt],
    kommentar,
    durationMs,
    durationMin,
    observer: state.observer,
    gembaType: state.type
  };

  state.entries.unshift(entry);
  saveEntries();

  // Update recents
  state.recentPatients = addToRecent(state.recentPatients, patient, 8);
  state.recentTasks = addToRecent(state.recentTasks, task, 6);
  buildTaskDropdown();
  renderRecentChips();

  // Reset form
  resetTimer();
  document.getElementById('taskSelect').value = '';
  document.getElementById('patientInput').value = '';
  document.getElementById('kommentarInput').value = '';
  document.querySelectorAll('#typeTagGroup .tag, #verrTagGroup .tag, #beteiligtGroup .tag')
    .forEach(t => t.className = 'tag');
  state.selectedType = '';
  state.selectedVerr = '';
  state.currentBeteiligt = [];

  renderEntries();
  renderMonitoring();
  showToast('‚úÖ Eintrag gespeichert');
}

// ===========================
// RENDER ENTRIES
// ===========================
function renderEntries() {
  const container = document.getElementById('entryList');
  document.getElementById('entryCount').textContent = state.entries.length;

  if (state.entries.length === 0) {
    container.innerHTML = `<div class="empty-state"><div class="ei">‚è±Ô∏è</div><p>Noch keine Eintr√§ge.<br>Starte auf dem Erfassungs-Tab.</p></div>`;
    return;
  }

  container.innerHTML = state.entries.map(e => {
    const barClass = typeBarClass(e.taetigkeitstyp);
    const tags = buildMiniTags(e);
    return `
      <div class="entry-card">
        <div class="entry-type-bar ${barClass}"></div>
        <div class="entry-body">
          <div class="entry-task">${e.task}</div>
          ${e.patient ? `<div class="entry-patient">üë§ ${e.patient}</div>` : ''}
          <div class="entry-tags">${tags}</div>
          ${e.kommentar ? `<div class="entry-note">üí¨ ${e.kommentar}</div>` : ''}
        </div>
        <div class="entry-right">
          <div class="entry-dur">${formatMin(e.durationMin)}</div>
          <div class="entry-time">${e.time}</div>
          <button class="entry-del" onclick="deleteEntry(${e.id})">‚úï</button>
        </div>
      </div>`;
  }).join('');
}

function typeBarClass(typ) {
  if (typ === 'wertsch√∂pfend') return 'bar-ws';
  if (typ === 'nicht wertsch√∂pfend') return 'bar-nws';
  if (typ === 'notwendig nicht wertsch√∂pfend') return 'bar-nnotw';
  return 'bar-none';
}

function buildMiniTags(e) {
  const tags = [];
  if (e.taetigkeitstyp === 'wertsch√∂pfend') tags.push('<span class="mini-tag mt-ws">‚úÖ Wertsch√∂pfend</span>');
  else if (e.taetigkeitstyp === 'nicht wertsch√∂pfend') tags.push('<span class="mini-tag mt-nws">‚ùå Nicht w.sch.</span>');
  else if (e.taetigkeitstyp === 'notwendig nicht wertsch√∂pfend') tags.push('<span class="mini-tag mt-nnotw">‚ö†Ô∏è Notwendig</span>');
  if (e.verrechnung === 'ja') tags.push('<span class="mini-tag mt-verr">üí∞ Verr.</span>');
  else if (e.verrechnung === 'nein') tags.push('<span class="mini-tag mt-nverr">‚Äî Nicht verr.</span>');
  if (e.beteiligt && e.beteiligt.length > 0) {
    tags.push(`<span class="mini-tag" style="background:var(--surface2);color:var(--text-muted);">${e.beteiligt.join(', ')}</span>`);
  }
  return tags.join('');
}

function deleteEntry(id) {
  state.entries = state.entries.filter(e => e.id !== id);
  saveEntries();
  renderEntries();
  renderMonitoring();
}

function clearAllEntries() {
  if (state.entries.length === 0) return;
  if (!confirm('Alle Eintr√§ge dieser Session l√∂schen?')) return;
  state.entries = [];
  saveEntries();
  renderEntries();
  renderMonitoring();
}

// ===========================
// MONITORING
// ===========================
function setMonView(view, btn) {
  state.monView = view;
  document.querySelectorAll('#monToggle .toggle-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderMonitoring();
}

function renderMonitoring() {
  const entries = state.entries;

  // KPIs
  const totalMs = entries.reduce((s, e) => s + e.durationMs, 0);
  const wsMs = entries.filter(e => e.taetigkeitstyp === 'wertsch√∂pfend').reduce((s, e) => s + e.durationMs, 0);
  const verrMs = entries.filter(e => e.verrechnung === 'ja').reduce((s, e) => s + e.durationMs, 0);
  document.getElementById('kpiTotal').textContent = formatMs(totalMs);
  document.getElementById('kpiCount').textContent = entries.length;
  document.getElementById('kpiWS').textContent = totalMs > 0 ? Math.round(wsMs / totalMs * 100) + '%' : '‚Äì';
  document.getElementById('kpiVerr').textContent = totalMs > 0 ? Math.round(verrMs / totalMs * 100) + '%' : '‚Äì';

  const container = document.getElementById('monContent');
  if (entries.length === 0) {
    container.innerHTML = '<div class="empty-state"><div class="ei">üìä</div><p>Noch keine Daten.</p></div>';
    return;
  }

  if (state.monView === 'task') {
    container.innerHTML = renderBarChart(groupBy(entries, 'task'), totalMs);
  } else if (state.monView === 'patient') {
    container.innerHTML = renderBarChart(groupBy(entries, 'patient', '(kein Patient)'), totalMs);
  } else {
    container.innerHTML = renderTypeChart(entries, totalMs);
  }
}

function groupBy(entries, key, fallback = '‚Äì') {
  const map = {};
  entries.forEach(e => {
    const k = e[key] || fallback;
    map[k] = (map[k] || 0) + e.durationMs;
  });
  return Object.entries(map).sort((a, b) => b[1] - a[1]);
}

function renderBarChart(data, totalMs) {
  if (data.length === 0) return '<p style="color:var(--text-muted);font-size:13px;">Keine Daten</p>';
  const max = data[0][1];
  return data.map(([name, ms]) => `
    <div class="bar-item">
      <div class="bar-name" title="${name}">${name}</div>
      <div class="bar-track">
        <div class="bar-fill fill-accent" style="width:${Math.round(ms/max*100)}%"></div>
      </div>
      <div class="bar-val">${formatMin(ms / 60000)}</div>
    </div>`).join('');
}

function renderTypeChart(entries, totalMs) {
  const types = [
    { key: 'wertsch√∂pfend', label: 'Wertsch√∂pfend', cls: 'fill-ws' },
    { key: 'nicht wertsch√∂pfend', label: 'Nicht wertsch√∂pfend', cls: 'fill-nws' },
    { key: 'notwendig nicht wertsch√∂pfend', label: 'Notwendig, n.w.', cls: 'fill-nnotw' },
    { key: '', label: 'Nicht klassifiziert', cls: 'fill-accent' }
  ];
  let html = '';
  types.forEach(({ key, label, cls }) => {
    const ms = entries.filter(e => e.taetigkeitstyp === key).reduce((s, e) => s + e.durationMs, 0);
    if (ms === 0) return;
    const pct = Math.round(ms / totalMs * 100);
    html += `
      <div class="bar-item">
        <div class="bar-name">${label}</div>
        <div class="bar-track">
          <div class="bar-fill ${cls}" style="width:${pct}%"></div>
        </div>
        <div class="bar-val">${pct}%</div>
      </div>`;
  });
  return html || '<p style="color:var(--text-muted);font-size:13px;">Keine klassifizierten Eintr√§ge</p>';
}

// ===========================
// EXPORT CSV
// ===========================
function exportCSV() {
  if (state.entries.length === 0) { showToast('‚ö†Ô∏è Keine Eintr√§ge zum Exportieren'); return; }

  const header = ['Zeit', 'Datum', 'Prozessschritt / Aktivit√§t', 'Patient', 'Gemba-Typ', 'Beobachter',
    'T√§tigkeitstyp', 'Verrechnung', 'Beteiligt', 'Dauer (min)', 'Beobachtung / Kommentar'];

  const rows = [...state.entries].reverse().map(e => [
    e.time,
    new Date(e.timestamp).toLocaleDateString('de-CH'),
    e.task,
    e.patient || '',
    e.gembaType === 'arzt' ? 'Arzt/Pflege' : 'Admin',
    e.observer,
    e.taetigkeitstyp || '',
    e.verrechnung || '',
    (e.beteiligt || []).join('; '),
    e.durationMin,
    e.kommentar || ''
  ]);

  const csv = [header, ...rows].map(r =>
    r.map(v => '"' + String(v).replace(/"/g, '""') + '"').join(';')
  ).join('\n');

  const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const dateStr = new Date().toLocaleDateString('de-CH').replace(/\./g, '-');
  a.href = url;
  a.download = `GembaWalk_${state.type}_${dateStr}.csv`;
  a.click();
  URL.revokeObjectURL(url);
  showToast('‚úÖ CSV exportiert');
}

// ===========================
// TABS
// ===========================
function switchTab(idx) {
  const screens = ['tabErfassung', 'tabEintraege', 'tabMonitoring'];
  screens.forEach((id, i) => {
    document.getElementById(id).classList.toggle('active', i === idx);
    document.getElementById('tab' + i).classList.toggle('active', i === idx);
  });
  if (idx === 2) renderMonitoring();
  if (idx === 1) renderEntries();
}

// ===========================
// HELPERS
// ===========================
function formatMs(ms) {
  if (ms === 0) return '0m';
  const h = Math.floor(ms / 3600000);
  const m = Math.floor((ms % 3600000) / 60000);
  if (h > 0) return `${h}h ${m}m`;
  return `${m}m`;
}

function formatMin(min) {
  if (!min || min === 0) return '0m';
  const h = Math.floor(min / 60);
  const m = Math.round(min % 60);
  if (h > 0) return `${h}h ${m}m`;
  return `${m}m`;
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('visible');
  setTimeout(() => t.classList.remove('visible'), 2200);
}

// ===========================
// EMAIL REPORT
// ===========================
function sendReportEmail() {
  if (state.entries.length === 0) { showToast('Keine Eintraege vorhanden'); return; }

  const totalMs = state.entries.reduce(function(s,e){ return s + e.durationMs; }, 0);
  const wsMs = state.entries.filter(function(e){ return e.taetigkeitstyp === 'wertschoepfend'; }).reduce(function(s,e){ return s + e.durationMs; }, 0);
  const nwsMs = state.entries.filter(function(e){ return e.taetigkeitstyp === 'nicht wertschoepfend'; }).reduce(function(s,e){ return s + e.durationMs; }, 0);
  const nnotwMs = state.entries.filter(function(e){ return e.taetigkeitstyp === 'notwendig nicht wertschoepfend'; }).reduce(function(s,e){ return s + e.durationMs; }, 0);
  const verrMs = state.entries.filter(function(e){ return e.verrechnung === 'ja'; }).reduce(function(s,e){ return s + e.durationMs; }, 0);
  const pct = function(ms) { return totalMs > 0 ? Math.round(ms / totalMs * 100) + '%' : '-'; };

  var taskMap = {};
  state.entries.forEach(function(e) { taskMap[e.task] = (taskMap[e.task] || 0) + e.durationMs; });
  var patMap = {};
  state.entries.forEach(function(e) { if(e.patient) patMap[e.patient] = (patMap[e.patient] || 0) + e.durationMs; });

  var lines = [
    'Gemba Walk Bericht',
    '==================',
    'Datum: ' + state.sessionDate,
    'Beobachter/in: ' + state.observer,
    'Typ: ' + (state.type === 'arzt' ? 'Arzt / Pflege' : 'Administration'),
    'Eintraege: ' + state.entries.length,
    'Gesamtzeit: ' + formatMs(totalMs),
    '',
    'TAETIGKEITSTYPEN',
    '----------------',
    'Wertschoepfend: ' + formatMs(wsMs) + ' (' + pct(wsMs) + ')',
    'Nicht wertschoepfend: ' + formatMs(nwsMs) + ' (' + pct(nwsMs) + ')',
    'Notwendig nws: ' + formatMs(nnotwMs) + ' (' + pct(nnotwMs) + ')',
    '',
    'VERRECHNUNG',
    '-----------',
    'Verrechenbar: ' + formatMs(verrMs) + ' (' + pct(verrMs) + ')',
    '',
    'TASKS (nach Zeit)',
    '-----------------'
  ];

  Object.entries(taskMap).sort(function(a,b){ return b[1]-a[1]; }).forEach(function(entry) {
    lines.push('  - ' + entry[0] + ': ' + formatMs(entry[1]) + ' (' + pct(entry[1]) + ')');
  });

  lines.push('');
  lines.push('PATIENTEN');
  lines.push('---------');
  Object.entries(patMap).sort(function(a,b){ return b[1]-a[1]; }).forEach(function(entry) {
    lines.push('  - ' + entry[0] + ': ' + formatMs(entry[1]));
  });

  lines.push('');
  lines.push('(CSV-Export separat herunterladen)');

  var subject = encodeURIComponent('Gemba Walk Bericht - ' + state.sessionDate + ' - ' + state.observer);
  var body = encodeURIComponent(lines.join('\n'));
  window.location.href = 'mailto:carmen.huber@kispisg.ch?subject=' + subject + '&body=' + body;
  showToast('Mail-App wird geoeffnet...');
}
</script>
</body>
</html>
